var App=Ember.Application.create({LOG_TRANSITIONS:!0});App.ApplicationAdapter=DS.RESTAdapter.extend({namespace:"api"}),$(document).ready(function(){"use strict";$(window).on("resize",fixedSidebarHeight),fixedSidebarHeight(),$(document).on("click",".more-info",showDescription)});var fixedSidebarHeight=function(){"use strict";$("aside").css("height",window.innerHeight+"px"),$("#content").css("height",window.innerHeight+"px")},showDescription=function(e){"use strict";var target=$(e.currentTarget),description=target.next(".description"),descriptionIsDisplayed=description.is(":visible");$(".description").slideUp(),descriptionIsDisplayed||description.slideDown()};App.Auth=function(){"use strict";function Auth(){$.cookie("logged","true")}return Auth.prototype.authorize_url=function(){return window.location.protocol+"//"+window.location.host+"/api/authorize"},Auth.prototype.login=function(callback){var loginWindow=window.open(this.authorize_url(),"login","height=500,width=800"),checkLogin=function(){try{loginWindow.closed&&(clearInterval(timer),callback(),$.cookie("logged","true"))}catch(e){console.log(e)}},timer=window.setInterval(checkLogin,500)},Auth.prototype.isLogged=function(){return"true"===$.cookie("logged")},Auth.prototype.withLoggedUser=function(callback){this.isLogged()&&callback()},Auth}(),window.auth=new App.Auth;var CHANNEL={};App.ApplicationRoute=Ember.Route.extend({setupController:function(controller){this.store.find("channel").then(function(channels){controller.set("channels",channels)})}}),App.IndexRoute=Ember.Route.extend({setupController:function(controller){_this=this,jQuery.getJSON("/api/suggestions").then(function(data){for(var i=data.channels.length-1;i>=0;i--)c=data.channels[i],episodes=_.where(data.episodes,{channel_id:c.id}),c.episodes=_.map(episodes,function(e){return _this.store.push("episode",e)}),data.channels[i]=c;controller.set("channels",data.channels)})}}),App.ChannelRoute=Ember.Route.extend({model:function(params){"use strict";return this.store.find("channel",params.channel_id)},activate:function(){var title=this.modelFor("channel").get("title");$(document).attr("title",title),$("[property='og:title']").attr("content",title)}}),App.ChannelController=Ember.ObjectController.extend({episodes:function(){return Ember.ArrayProxy.createWithMixins(Ember.SortableMixin,{sortProperties:["published_at"],sortAscending:!1,content:this.get("content.episodes")})}.property("content.episodes")}),App.PlayerController=Ember.ObjectController.extend({content:[],actions:{}}).create(),App.Channel=DS.Model.extend({title:DS.attr(),image_url:DS.attr(),url:DS.attr(),uri:DS.attr(),description:DS.attr(),copyright:DS.attr(),subscribed:DS.attr(),episodes:DS.hasMany("episode",{async:!0}),to_view:DS.attr()}),App.Episode=DS.Model.extend({title:DS.attr(),description:DS.attr(),source_url:DS.attr(),playing:DS.attr(),listened:DS.attr(),published_at:DS.attr(),channel_id:DS.attr("number"),uri:DS.attr(),duration:DS.attr(),durationISO:function(){return duration=this.get("duration"),2==duration.split(":").length&&(duration="00:"+duration),duration=moment.duration(duration),duration.toIsoString()}.property("duration"),channel:function(){return this.store.findById("channel",this.get("channel_id"))}.property("channel_id"),url:function(){return host=window.location.host,"http://"+host+"/channels/"+this.get("channel_id")+"/"+this.get("uri")}.property("channel_id","id")}),App.Player={},App.Player.episodes={},App.Player.events={},App.Player.events.play=function(){},App.Player.events.pause=function(){},App.Player.events.loading=function(){},App.Player.events.playing=function(){},App.Player.events.onload=function(){this.onPosition(.95*this.duration,function(){var episode=App.Player.playing;App.Player.listened(episode)})},App.Player.getAudio=function(id){if(!App.Player.episodes[id]){var el=$("[data-id="+id+"]"),audio=el.data(),sound=soundManager.createSound({id:"e"+audio.id,url:[audio.source_url],onplay:App.Player.events.play,onpause:App.Player.events.pause,whileloading:App.Player.events.loading,whileplaying:App.Player.events.playing,onload:App.Player.events.onload});App.Player.episodes[id]=sound}return App.Player.episodes[id]},App.Player.play=function(episode){playingEpisode=App.Player.playing,playingEpisode&&App.Player.stop(playingEpisode);var audio=this.getAudio(episode.id);audio.play(),App.Player.playing=episode,episode.set("playing",!0)},App.Player.pause=function(episode){App.Player.episodes[episode.id].pause(),episode.set("playing",!1)},App.Player.stop=function(episode){App.Player.episodes[playingEpisode.id].destruct(),episode.set("playing",!1)},App.Player.playpause=function(episode){var isPlaying=episode.get("playing");isPlaying?App.Player.pause(episode):App.Player.play(episode)},App.Player.listened=function(episode){var url="/api/episodes/"+episode.id+"/listened";$.post(url).then(function(){episode.set("listened",!0)})},soundManager.setup({url:"/swf",flashVersion:9,useHTML5Audio:!0,preferFlash:!1,waitForWindowLoad:!0,debugMode:!1,useFlashBlock:!1,autoLoad:!0}),App.Router.map(function(){"use strict";this.route("channel.new",{path:"/new"}),this.route("channel",{path:"/:channel_id"})}),App.Router.reopen({rootURL:"/app/",location:"history"}),Ember.TEMPLATES.application=Ember.Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){data.buffer.push('\n          <span class="typcn typcn-home-outline"></span>Home\n        ')}function program3(depth0,data){data.buffer.push('\n          <span class="typcn typcn-document-add"></span>Add Channel\n        ')}function program5(depth0,data){var stack1,helper,options,buffer="";return data.buffer.push("\n      <li>\n        "),helper=helpers["link-to"]||depth0&&depth0["link-to"],options={hash:{},hashTypes:{},hashContexts:{},inverse:self.noop,fn:self.program(6,program6,data),contexts:[depth0,depth0],types:["STRING","ID"],data:data},stack1=helper?helper.call(depth0,"channel","channel.id",options):helperMissing.call(depth0,"link-to","channel","channel.id",options),(stack1||0===stack1)&&data.buffer.push(stack1),data.buffer.push("\n      </li>\n    "),buffer}function program6(depth0,data){var stack1,buffer="";return data.buffer.push("\n          <img "),data.buffer.push(escapeExpression(helpers["bind-attr"].call(depth0,{hash:{src:"channel.image_url"},hashTypes:{src:"ID"},hashContexts:{src:depth0},contexts:[],types:[],data:data}))),data.buffer.push(' />\n          <span class="title">'),stack1=helpers._triageMustache.call(depth0,"channel.title",{hash:{},hashTypes:{},hashContexts:{},contexts:[depth0],types:["ID"],data:data}),(stack1||0===stack1)&&data.buffer.push(stack1),data.buffer.push("</span>\n          <i>"),stack1=helpers._triageMustache.call(depth0,"channel.to_view",{hash:{},hashTypes:{},hashContexts:{},contexts:[depth0],types:["ID"],data:data}),(stack1||0===stack1)&&data.buffer.push(stack1),data.buffer.push("</i>\n        "),buffer}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Ember.Handlebars.helpers),data=data||{};var stack1,helper,options,buffer="",escapeExpression=this.escapeExpression,self=this,helperMissing=helpers.helperMissing;return data.buffer.push('<div id="aside-wrapper" class="column three-twelfth">\n  <aside class="column three-twelfth">\n    <header>\n      <hgroup>\n        <h1>Uhura</h1>\n        <h2>Podcast Manager</h2>\n      </hgroup>\n    </header>\n\n    <ul>\n      <li>\n        '),helper=helpers["link-to"]||depth0&&depth0["link-to"],options={hash:{},hashTypes:{},hashContexts:{},inverse:self.noop,fn:self.program(1,program1,data),contexts:[depth0],types:["STRING"],data:data},stack1=helper?helper.call(depth0,"index",options):helperMissing.call(depth0,"link-to","index",options),(stack1||0===stack1)&&data.buffer.push(stack1),data.buffer.push("\n      </li>\n      <li>\n        "),helper=helpers["link-to"]||depth0&&depth0["link-to"],options={hash:{},hashTypes:{},hashContexts:{},inverse:self.noop,fn:self.program(3,program3,data),contexts:[depth0],types:["STRING"],data:data},stack1=helper?helper.call(depth0,"channel.new",options):helperMissing.call(depth0,"link-to","channel.new",options),(stack1||0===stack1)&&data.buffer.push(stack1),data.buffer.push("\n      </li>\n    </ul>\n    <ol>\n    "),stack1=helpers.each.call(depth0,"channel","in","channels",{hash:{},hashTypes:{},hashContexts:{},inverse:self.noop,fn:self.program(5,program5,data),contexts:[depth0,depth0,depth0],types:["ID","ID","ID"],data:data}),(stack1||0===stack1)&&data.buffer.push(stack1),data.buffer.push('\n    </ol>\n\n    <footer>\n    <a>Follow us <span class="typcn typcn-social-twitter"></span></a>\n    </footer>\n  </aside>\n</div>\n\n\n\n<div id="content" class="column nine-twelfth">\n  '),stack1=helpers._triageMustache.call(depth0,"outlet",{hash:{},hashTypes:{},hashContexts:{},contexts:[depth0],types:["ID"],data:data}),(stack1||0===stack1)&&data.buffer.push(stack1),data.buffer.push('\n</div>\n\n<div id="fb-root"></div>\n'),buffer}),Ember.TEMPLATES.channel=Ember.Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var helper,options,buffer="";return data.buffer.push("\n    "),data.buffer.push(escapeExpression((helper=helpers["episode-list-item"]||depth0&&depth0["episode-list-item"],options={hash:{episode:"episode"},hashTypes:{episode:"ID"},hashContexts:{episode:depth0},contexts:[],types:[],data:data},helper?helper.call(depth0,options):helperMissing.call(depth0,"episode-list-item",options)))),data.buffer.push("\n  "),buffer}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Ember.Handlebars.helpers),data=data||{};var stack1,buffer="",helperMissing=helpers.helperMissing,escapeExpression=this.escapeExpression,self=this;return data.buffer.push("<h2>"),stack1=helpers._triageMustache.call(depth0,"title",{hash:{},hashTypes:{},hashContexts:{},contexts:[depth0],types:["ID"],data:data}),(stack1||0===stack1)&&data.buffer.push(stack1),data.buffer.push('</h2>\n\n<ul class="episodes">\n  '),stack1=helpers.each.call(depth0,"episode","in","episodes",{hash:{},hashTypes:{},hashContexts:{},inverse:self.noop,fn:self.program(1,program1,data),contexts:[depth0,depth0,depth0],types:["ID","ID","ID"],data:data}),(stack1||0===stack1)&&data.buffer.push(stack1),data.buffer.push("\n</ul>\n"),buffer}),Ember.TEMPLATES.channel_new=Ember.Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Ember.Handlebars.helpers),data=data||{},data.buffer.push('<h3>Add Channel</h3>\n\n\n<form class="uk-search" data-uk-search>\n    <input class="uk-search-field" type="search" placeholder="">\n    <button class="uk-search-close" type="reset"></button>\n</form>\n')}),Ember.TEMPLATES["component/episode-list-item"]=Ember.Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Ember.Handlebars.helpers),data=data||{};var stack1,helper,options,buffer="",escapeExpression=this.escapeExpression,helperMissing=helpers.helperMissing;return data.buffer.push("<li "),data.buffer.push(escapeExpression(helpers["bind-attr"].call(depth0,{hash:{"class":":audio episode.listened episode.playing"},hashTypes:{"class":"STRING"},hashContexts:{"class":depth0},contexts:[],types:[],data:data}))),data.buffer.push(" "),data.buffer.push(escapeExpression(helpers["bind-attr"].call(depth0,{hash:{"data-id":"episode.id"},hashTypes:{"data-id":"ID"},hashContexts:{"data-id":depth0},contexts:[],types:[],data:data}))),data.buffer.push(" "),data.buffer.push(escapeExpression(helpers["bind-attr"].call(depth0,{hash:{"data-source_url":"episode.source_url"},hashTypes:{"data-source_url":"ID"},hashContexts:{"data-source_url":depth0},contexts:[],types:[],data:data}))),data.buffer.push(">\n  "),data.buffer.push(escapeExpression((helper=helpers["play-pause-button"]||depth0&&depth0["play-pause-button"],options={hash:{episode:"episode"},hashTypes:{episode:"ID"},hashContexts:{episode:depth0},contexts:[],types:[],data:data},helper?helper.call(depth0,options):helperMissing.call(depth0,"play-pause-button",options)))),data.buffer.push('\n  <div class="title">\n    '),stack1=helpers._triageMustache.call(depth0,"episode.title",{hash:{},hashTypes:{},hashContexts:{},contexts:[depth0],types:["ID"],data:data}),(stack1||0===stack1)&&data.buffer.push(stack1),data.buffer.push('\n  </div>\n  <button title="Information" class="more-info typcn typcn-info-large"> </button>\n  <div class="description">\n    '),data.buffer.push(escapeExpression(helpers._triageMustache.call(depth0,"episode.description",{hash:{unescaped:"true"},hashTypes:{unescaped:"STRING"},hashContexts:{unescaped:depth0},contexts:[depth0],types:["ID"],data:data}))),data.buffer.push("\n  </div>\n</li>\n"),buffer}),Ember.TEMPLATES["component/play-pause-button"]=Ember.Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Ember.Handlebars.helpers),data=data||{};var buffer="",escapeExpression=this.escapeExpression;return data.buffer.push("<i "),data.buffer.push(escapeExpression(helpers["bind-attr"].call(depth0,{hash:{"class":":typcn episode.playing:typcn-media-pause:typcn-media-play"},hashTypes:{"class":"STRING"},hashContexts:{"class":depth0},contexts:[],types:[],data:data}))),data.buffer.push(" "),data.buffer.push(escapeExpression(helpers.action.call(depth0,"playpause","episode",{hash:{},hashTypes:{},hashContexts:{},contexts:[depth0,depth0],types:["STRING","ID"],data:data}))),data.buffer.push(">\n</i>\n\n\n\n"),buffer}),Ember.TEMPLATES.index=Ember.Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,buffer="";return data.buffer.push('\n    <li>\n      <h3><span class="typcn typcn-th-large-outline"></span>'),stack1=helpers._triageMustache.call(depth0,"channel.title",{hash:{},hashTypes:{},hashContexts:{},contexts:[depth0],types:["ID"],data:data}),(stack1||0===stack1)&&data.buffer.push(stack1),data.buffer.push('</h3>\n      <ul class="episodes">\n        '),stack1=helpers.each.call(depth0,"episode","in","channel.episodes",{hash:{},hashTypes:{},hashContexts:{},inverse:self.noop,fn:self.program(2,program2,data),contexts:[depth0,depth0,depth0],types:["ID","ID","ID"],data:data}),(stack1||0===stack1)&&data.buffer.push(stack1),data.buffer.push("\n      </ul>\n    </li>\n  "),buffer}function program2(depth0,data){var helper,options,buffer="";return data.buffer.push("\n          "),data.buffer.push(escapeExpression((helper=helpers["episode-list-item"]||depth0&&depth0["episode-list-item"],options={hash:{episode:"episode"},hashTypes:{episode:"ID"},hashContexts:{episode:depth0},contexts:[],types:[],data:data},helper?helper.call(depth0,options):helperMissing.call(depth0,"episode-list-item",options)))),data.buffer.push("\n        "),buffer}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Ember.Handlebars.helpers),data=data||{};var stack1,buffer="",helperMissing=helpers.helperMissing,escapeExpression=this.escapeExpression,self=this;return data.buffer.push('<h2>Suggestions</h2>\n<ul id="channels">\n  '),stack1=helpers.each.call(depth0,"channel","in","channels",{hash:{},hashTypes:{},hashContexts:{},inverse:self.noop,fn:self.program(1,program1,data),contexts:[depth0,depth0,depth0],types:["ID","ID","ID"],data:data}),(stack1||0===stack1)&&data.buffer.push(stack1),data.buffer.push("\n</ul>\n"),buffer}),Ember.TEMPLATES.player=Ember.Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,buffer="";return data.buffer.push('\n    <div class="Player">\n      <a href="#" '),data.buffer.push(escapeExpression(helpers.action.call(depth0,"play_pause","model",{hash:{},hashTypes:{},hashContexts:{},contexts:[depth0,depth0],types:["ID","ID"],data:data}))),data.buffer.push(">\n        "),stack1=helpers["if"].call(depth0,"playing",{hash:{},hashTypes:{},hashContexts:{},inverse:self.program(4,program4,data),fn:self.program(2,program2,data),contexts:[depth0],types:["ID"],data:data}),(stack1||0===stack1)&&data.buffer.push(stack1),data.buffer.push('\n      </a>\n      <div class="PlayerLoader">\n        <div class="loading"></div>\n        <div class="playing"></div>\n      </div>\n      <span class="title">'),stack1=helpers._triageMustache.call(depth0,"title",{hash:{},hashTypes:{},hashContexts:{},contexts:[depth0],types:["ID"],data:data}),(stack1||0===stack1)&&data.buffer.push(stack1),data.buffer.push("</span>\n    </div>\n    "),buffer}function program2(depth0,data){data.buffer.push('<i class="fa fa-pause"></i>')}function program4(depth0,data){data.buffer.push('<i class="fa fa-play"></i>')}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Ember.Handlebars.helpers),data=data||{};var stack1,buffer="",escapeExpression=this.escapeExpression,self=this;return data.buffer.push("    "),stack1=helpers["if"].call(depth0,"model",{hash:{},hashTypes:{},hashContexts:{},inverse:self.noop,fn:self.program(1,program1,data),contexts:[depth0],types:["ID"],data:data}),(stack1||0===stack1)&&data.buffer.push(stack1),data.buffer.push("\n"),buffer}),App.ChannelNewView=Ember.View.extend({templateName:"channel_new"}),App.EpisodeListItemComponent=Ember.Component.extend({layoutName:"component/episode-list-item",actions:{}}),App.PlayPauseButtonComponent=Ember.Component.extend({layoutName:"component/play-pause-button",classNames:["play-pause"],actions:{playpause:function(episode){var __playing=function(episode){return function(){App.Player.playpause(episode)}};window.auth.withLoggedUser(__playing(episode))}}}),App.PlayerView=Ember.View.extend({templateName:"player",classNames:["PlayerContainer"],controller:App.PlayerController});